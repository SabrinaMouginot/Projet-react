'use strict';Object.defineProperty(exports,'__esModule',{value:!0}),exports.ColorPickerMenu=void 0;var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h['return']&&h['return']()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),_react=require('react'),_react2=_interopRequireDefault(_react),_styledComponents=require('styled-components'),_propTypes=require('prop-types'),_propTypes2=_interopRequireDefault(_propTypes),_props=require('../helpers/props'),_styled=require('./styled'),_portal=require('./portal'),_portal2=_interopRequireDefault(_portal),_selectedColorIcon=require('./icons/selectedColorIcon'),_selectedColorIcon2=_interopRequireDefault(_selectedColorIcon),_newColorSection=require('./newColorSection'),_newColorSection2=_interopRequireDefault(_newColorSection),_removeButtonIcon=require('./icons/removeButtonIcon'),_removeButtonIcon2=_interopRequireDefault(_removeButtonIcon),_addNewButtonIcon=require('./icons/addNewButtonIcon'),_addNewButtonIcon2=_interopRequireDefault(_addNewButtonIcon),_getColorInAllFormats=require('../helpers/getColorInAllFormats'),_schema=require('../theme/schema.json'),_schema2=_interopRequireDefault(_schema);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var ColorPickerMenu=exports.ColorPickerMenu=(0,_react.forwardRef)(function(a,b){var c=a.colors,d=a.selected,e=a.removeColor,f=a.theme,g=f===void 0?'light':f,h=a.enableAddNew,j=!(h!==void 0)||h,k=a.defaultFormat,l=k===void 0?'hex':k,m=a.allowedFormats,n=m===void 0?['hex','rgb','hsl']:m,o=a.itemsPerRow,p=o===void 0?6:o,q=a.onChange,r=a.onHide,s=d?d.toUpperCase():null,t=(0,_react.useState)(!1),u=_slicedToArray(t,2),v=u[0],w=u[1],x=(0,_react.useState)(!1),y=_slicedToArray(x,2),z=y[0],A=y[1],B=(0,_react.useRef)(null),C=(0,_react.useRef)(null),D=[c];if(c&&c.length>p){D=[];for(var E=0;E<c.length;E+=p)D.push(c.slice(E,E+p))}c||(D=[['#FF6666','#ffd166','#66FF7D','#66F6FF','#A366FF','#FF66D9']]),(0,_react.useEffect)(function(){var a=B.current;if(a){var c={bottom:0,left:0},d=void 0;b&&b.current&&(d=b.current,c=d.getBoundingClientRect());var e={top:c.bottom+4,left:c.left+4};a.style.opacity='1',a.style.top=e.top+'px',a.style.left=e.left+'px';var f=C.current;if(r||j){var g=function(b){a.contains(b.target)?j&&z&&!f.contains(b.target)&&A(!1):r&&(!d||d&&!d.contains(b.target))&&r()};return document.addEventListener('mousedown',g),function(){document.removeEventListener('mousedown',g)}}}});var F=function(a){if(v&&w(!1),q){var b=(0,_getColorInAllFormats.getColorInAllFormats)(a);q(b)}},G=function(){var a={};'transparent'===e?a.hex='transparent':a=(0,_getColorInAllFormats.getColorInAllFormats)(e),q(a)};return _react2.default.createElement(_portal2.default,null,_react2.default.createElement(_styledComponents.ThemeProvider,{theme:_schema2.default[g]},_react2.default.createElement(_styled.Wrapper,{ref:B,className:'colorPickerMenu'},_react2.default.createElement(_styled.Container,null,_react2.default.createElement(_styled.ColorsContainer,null,D.map(function(a,b){return _react2.default.createElement(_styled.ColorsRow,{key:b,isLast:b+1===D.length},e&&0===b?_react2.default.createElement(_styled.RemoveButton,{onClick:G},_react2.default.createElement(_removeButtonIcon2.default,null)):null,a.map(function(b,c){var d=s===b.toUpperCase();return _react2.default.createElement(_styled.ColorButton,{key:b,color:b,isSelected:d,isLast:c+1===a.length,onClick:function a(){return F(b)}},d&&_react2.default.createElement(_selectedColorIcon2.default,{color:b}))}),j&&b===D.length-1&&_react2.default.createElement(_styled.AddNewButton,{onClick:function a(){return w(!v)}},_react2.default.createElement(_addNewButtonIcon2.default,null)))}))),v&&_react2.default.createElement(_newColorSection2.default,{defaultFormat:l,allowedFormats:n,onChange:q,onSuccess:function a(){w(!1)},formatPicker:{ref:C,display:z,toggle:function a(){A(!z)}}}))))});ColorPickerMenu.propTypes={colors:_propTypes2.default.arrayOf(_props.isValidHexColor),selected:_props.isValidHex,removeColor:_props.isValidHex,theme:_propTypes2.default.oneOf(['light','dark']),enableAddNew:_propTypes2.default.oneOf([!0,!1,'true','false']),defaultFormat:_propTypes2.default.oneOf(['hex','rgb','hsl']),allowedFormats:_propTypes2.default.arrayOf(_propTypes2.default.oneOf(['hex','rgb','hsl'])),itemsPerRow:_propTypes2.default.number,onChange:_propTypes2.default.func,onHide:_propTypes2.default.func};